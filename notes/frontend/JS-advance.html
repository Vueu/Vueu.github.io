<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>JS高级 | Aavin&#39;s blog</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/egg.png">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/egg.png">
    <link rel="mask-icon" href="/bg.svg" color="#3eaf7c">
    <script>
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "https://hm.baidu.com/hm.js?xxxxxxxxxxxxxxxxxxxx"; 
          var s = document.getElementsByTagName("script")[0]; 
          s.parentNode.insertBefore(hm, s);
        })();</script>
    <meta name="description" content="">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/egg.png">
    <meta name="msapplication-TileColor" content="#000000">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    <meta name="keywords" content="Aavin,博客,conimi,nico">
    
    <link rel="preload" href="/assets/css/0.styles.0474e23b.css" as="style"><link rel="preload" href="/assets/js/app.7562fe1d.js" as="script"><link rel="preload" href="/assets/js/3.9f83703d.js" as="script"><link rel="preload" href="/assets/js/1.37c29b95.js" as="script"><link rel="preload" href="/assets/js/7.8b4bf124.js" as="script"><link rel="preload" href="/assets/js/16.170be8d2.js" as="script"><link rel="prefetch" href="/assets/js/10.023ac5e0.js"><link rel="prefetch" href="/assets/js/11.db329df4.js"><link rel="prefetch" href="/assets/js/12.81218ff5.js"><link rel="prefetch" href="/assets/js/13.9fa48958.js"><link rel="prefetch" href="/assets/js/14.63184c91.js"><link rel="prefetch" href="/assets/js/15.88b47c89.js"><link rel="prefetch" href="/assets/js/17.d0f22d22.js"><link rel="prefetch" href="/assets/js/18.5fe890ec.js"><link rel="prefetch" href="/assets/js/19.900f91d0.js"><link rel="prefetch" href="/assets/js/20.36b5239f.js"><link rel="prefetch" href="/assets/js/21.2f8b3162.js"><link rel="prefetch" href="/assets/js/22.5c435efd.js"><link rel="prefetch" href="/assets/js/23.92de4ab3.js"><link rel="prefetch" href="/assets/js/24.0e85461f.js"><link rel="prefetch" href="/assets/js/25.845e0357.js"><link rel="prefetch" href="/assets/js/26.de966fad.js"><link rel="prefetch" href="/assets/js/27.95b0c99d.js"><link rel="prefetch" href="/assets/js/28.f5a033a8.js"><link rel="prefetch" href="/assets/js/29.90608871.js"><link rel="prefetch" href="/assets/js/30.cb3e9f42.js"><link rel="prefetch" href="/assets/js/31.a6a91589.js"><link rel="prefetch" href="/assets/js/32.c2f9fda0.js"><link rel="prefetch" href="/assets/js/33.f85f7981.js"><link rel="prefetch" href="/assets/js/34.bd614d76.js"><link rel="prefetch" href="/assets/js/35.10054677.js"><link rel="prefetch" href="/assets/js/36.d60dfc50.js"><link rel="prefetch" href="/assets/js/37.54c0dd3c.js"><link rel="prefetch" href="/assets/js/38.a111b9a8.js"><link rel="prefetch" href="/assets/js/39.979cf0fc.js"><link rel="prefetch" href="/assets/js/4.6e27e86e.js"><link rel="prefetch" href="/assets/js/40.ba0a7154.js"><link rel="prefetch" href="/assets/js/41.1e63b29e.js"><link rel="prefetch" href="/assets/js/42.f8a90803.js"><link rel="prefetch" href="/assets/js/43.11adf18f.js"><link rel="prefetch" href="/assets/js/44.1d3e67c6.js"><link rel="prefetch" href="/assets/js/45.a0ebcb9c.js"><link rel="prefetch" href="/assets/js/46.9bbca23c.js"><link rel="prefetch" href="/assets/js/5.d7d66890.js"><link rel="prefetch" href="/assets/js/6.6e69b93a.js"><link rel="prefetch" href="/assets/js/8.60ee857e.js"><link rel="prefetch" href="/assets/js/9.ee70221a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.0474e23b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar" data-v-7dd95ae2><div data-v-7dd95ae2><div class="password-shadow password-wrapper-out" style="display:none;" data-v-59e6cb88 data-v-7dd95ae2 data-v-7dd95ae2><h3 class="title" data-v-59e6cb88>Aavin's blog</h3> <p class="description" data-v-59e6cb88></p> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><span data-v-59e6cb88>Aavin</span>
          
        <span data-v-59e6cb88>2021 - </span>
        2023
      </a></span></div></div> <div class="hide" data-v-7dd95ae2><header class="navbar" data-v-7dd95ae2><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/egg.png" alt="Aavin's blog" class="logo"> <span class="site-name">Aavin's blog</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/前端笔记/" class="nav-link"><i class="undefined"></i>
  前端笔记
</a></li><li class="dropdown-item"><!----> <a href="/categories/博客搭建/" class="nav-link"><i class="undefined"></i>
  博客搭建
</a></li><li class="dropdown-item"><!----> <a href="/categories/学习文档/" class="nav-link"><i class="undefined"></i>
  学习文档
</a></li><li class="dropdown-item"><!----> <a href="/categories/后端笔记/" class="nav-link"><i class="undefined"></i>
  后端笔记
</a></li><li class="dropdown-item"><!----> <a href="/categories/学习路线/" class="nav-link"><i class="undefined"></i>
  学习路线
</a></li><li class="dropdown-item"><!----> <a href="/categories/前端工具/" class="nav-link"><i class="undefined"></i>
  前端工具
</a></li><li class="dropdown-item"><!----> <a href="/categories/控制/" class="nav-link"><i class="undefined"></i>
  控制
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-document"></i>
      文档
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/documents/frontend.html" class="nav-link"><i class="undefined"></i>
  前端文档
</a></li><li class="dropdown-item"><!----> <a href="/documents/backend.html" class="nav-link"><i class="undefined"></i>
  后端文档
</a></li></ul></div></div><div class="nav-item"><a href="/notes/frontend/.html" class="nav-link"><i class="iconfont reco-blog"></i>
  面试
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  归档
</a></div><div class="nav-item"><a href="/pages/msg.html" class="nav-link"><i class="iconfont reco-suggestion"></i>
  留言
</a></div><div class="nav-item"><a href="https://github.com/Vueu/vuepress-app" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="/pages/test.html" class="nav-link"><i class="iconfont reco-faq"></i>
  测试
</a></div><div class="nav-item"><a href="/pages/about.html" class="nav-link"><i class="iconfont reco-account"></i>
  关于
</a></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-7dd95ae2></div> <aside class="sidebar" data-v-7dd95ae2><div class="personal-info-wrapper" data-v-1fad0c41 data-v-7dd95ae2><img src="/avatar.jpg" alt="author-avatar" class="personal-img" data-v-1fad0c41> <h3 class="name" data-v-1fad0c41>
    Aavin
  </h3> <div class="num" data-v-1fad0c41><div data-v-1fad0c41><h3 data-v-1fad0c41>29</h3> <h6 data-v-1fad0c41>文章</h6></div> <div data-v-1fad0c41><h3 data-v-1fad0c41>30</h3> <h6 data-v-1fad0c41>标签</h6></div></div> <ul class="social-links" data-v-1fad0c41><li class="social-item" data-v-1fad0c41><i class="iconfont reco-github" style="color:#3498db;" data-v-1fad0c41></i></li><li class="social-item" data-v-1fad0c41><i class="iconfont reco-zhihu" style="color:#3498db;" data-v-1fad0c41></i></li><li class="social-item" data-v-1fad0c41><i class="iconfont reco-wechat" style="color:#67cc86;" data-v-1fad0c41></i></li><li class="social-item" data-v-1fad0c41><i class="iconfont reco-bilibili" style="color:#f8b26a;" data-v-1fad0c41></i></li></ul> <hr data-v-1fad0c41></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/前端笔记/" class="nav-link"><i class="undefined"></i>
  前端笔记
</a></li><li class="dropdown-item"><!----> <a href="/categories/博客搭建/" class="nav-link"><i class="undefined"></i>
  博客搭建
</a></li><li class="dropdown-item"><!----> <a href="/categories/学习文档/" class="nav-link"><i class="undefined"></i>
  学习文档
</a></li><li class="dropdown-item"><!----> <a href="/categories/后端笔记/" class="nav-link"><i class="undefined"></i>
  后端笔记
</a></li><li class="dropdown-item"><!----> <a href="/categories/学习路线/" class="nav-link"><i class="undefined"></i>
  学习路线
</a></li><li class="dropdown-item"><!----> <a href="/categories/前端工具/" class="nav-link"><i class="undefined"></i>
  前端工具
</a></li><li class="dropdown-item"><!----> <a href="/categories/控制/" class="nav-link"><i class="undefined"></i>
  控制
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-document"></i>
      文档
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/documents/frontend.html" class="nav-link"><i class="undefined"></i>
  前端文档
</a></li><li class="dropdown-item"><!----> <a href="/documents/backend.html" class="nav-link"><i class="undefined"></i>
  后端文档
</a></li></ul></div></div><div class="nav-item"><a href="/notes/frontend/.html" class="nav-link"><i class="iconfont reco-blog"></i>
  面试
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  归档
</a></div><div class="nav-item"><a href="/pages/msg.html" class="nav-link"><i class="iconfont reco-suggestion"></i>
  留言
</a></div><div class="nav-item"><a href="https://github.com/Vueu/vuepress-app" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="/pages/test.html" class="nav-link"><i class="iconfont reco-faq"></i>
  测试
</a></div><div class="nav-item"><a href="/pages/about.html" class="nav-link"><i class="iconfont reco-account"></i>
  关于
</a></div> <!----></nav> <!----> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-59e6cb88 data-v-7dd95ae2><h3 class="title" data-v-59e6cb88>JS高级</h3> <!----> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><span data-v-59e6cb88>Aavin</span>
          
        <span data-v-59e6cb88>2021 - </span>
        2023
      </a></span></div></div> <div data-v-7dd95ae2><div data-v-7dd95ae2><main class="page"><section style="display:;"><div class="page-title"><h1 class="title">JS高级</h1> <div data-v-8a445198><i class="iconfont reco-account" data-v-8a445198><span data-v-8a445198>Aavin</span></i> <i class="iconfont reco-date" data-v-8a445198><span data-v-8a445198>2022/2/13</span></i> <i class="iconfont reco-eye" data-v-8a445198><span id="/notes/frontend/JS-advance.html" data-flag-title="Your Article Title" class="leancloud-visitors" data-v-8a445198><a class="leancloud-visitors-count" style="font-size:.9rem;font-weight:normal;color:#999;"></a></span></i> <i class="tags iconfont reco-tag" data-v-8a445198><span class="tag-item" data-v-8a445198>JavaScript</span></i></div></div> <div class="theme-reco-content content__default"><h3 id="_1-数据类型"><a href="#_1-数据类型" class="header-anchor">#</a> 1.数据类型</h3> <blockquote><p>分类</p></blockquote> <p>基本(值)类型：</p> <p>String:任意字符串，Number:任意的数字，boolean : true/false，undefined : undefined，null: null 。</p> <p>对象(引用)类型：</p> <p>Object:任意对象，Function:—种特别的对象(可以执行)，Array:—种特别的对象(数值下标，内部数据是有序的)。</p> <blockquote><p>判断</p></blockquote> <p>typeof ，可以判断: undefined / 数值 / 字符串 / 布尔值 /function。typeof 返回数据类型的<strong>字符串表达</strong>。不能判断：不能区分null和object ，object和array，要用instanceof 区分。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> a <span class="token operator">===</span> <span class="token string">&quot;number&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//true</span>

<span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span><span class="token keyword">typeof</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//{} 'object'</span>

<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> c <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span> d <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> b<span class="token punctuation">,</span> <span class="token keyword">typeof</span> c<span class="token punctuation">,</span> <span class="token keyword">typeof</span> d<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//三个object</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>instanceof 判断对象的具体类型
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//判断实例对象</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj <span class="token keyword">instanceof</span> <span class="token class-name">Object</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>=== 可以判断: undefined，null
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> a <span class="token operator">===</span> <span class="token string">&quot;number&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//true</span>

<span class="token keyword">var</span> b<span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b <span class="token operator">===</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span> <span class="token keyword">typeof</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//true undefined</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="_2-相关问题"><a href="#_2-相关问题" class="header-anchor">#</a> 2.相关问题</h3> <blockquote><p>undefined 与null的区别?</p></blockquote> <p>undefined代表定义未赋值；null 定义并赋值了，只是值为null。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//undefined 与nulL的区别?</span>
<span class="token keyword">var</span> a<span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// undefined </span>
a <span class="token operator">=</span> <span class="token keyword">null</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// null</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><blockquote><p>什么时候给变量赋值为null呢?</p></blockquote> <p>初始赋值，表明将要赋值为对象；结束前，让变量指向的对象成为垃圾对象(被垃圾回收器回收)。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//起始</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span><span class="token comment">//初始赋值为null，表明将要赋值为对象</span>
<span class="token comment">//确定对象就赋值</span>
b<span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'atguigu'</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">//最后</span>
b<span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span><span class="token comment">//让b指向的对象成为垃圾对象(被垃圾回收器回收)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><blockquote><p>严格区别变量类型与数据类型?</p></blockquote> <p>数据的类型：基本类型，对象类型；变量的类型(变量内存值的类型)：基本类型，保存就是基本类型的数据；引用类型，保存的是地址值。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//将{}的地址值赋给obj</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//obj存于栈，存储了{}的地址，{}存于堆，obj --&gt; {};</span>

<span class="token comment">//将function(){}的地址值赋给of报存</span>
<span class="token keyword">var</span> <span class="token function-variable function">of</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><blockquote><p>内存分类 ?</p></blockquote> <p>栈，存全局变量/局部变量；堆，存对象。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//obj存于栈，{name:&quot;obj&quot;}存于堆</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">&quot;obj&quot;</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//f存于栈，function(){alert(&quot;ff&quot;)}存于堆</span>
<span class="token keyword">var</span> <span class="token function-variable function">f</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;ff&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><blockquote><p>var a = X，a内存中到底保存的是什么?</p></blockquote> <p>X 是基本数据，a 保存的就是这个数据；X是对象，a 保存的是对象的地址值。X 是个变量，保存的 X 的内存内容(可能是基本数据，也可能是地址值)。</p> <blockquote><p>在js调用函数时传递变量参数时，是值传递还是引用传递？</p></blockquote> <p>理解1∶都是值(基本/地址值)传递。</p> <p>理解2 : 可能是值传无递弟，也可能是引用传递（地址值）。</p> <blockquote><p>JS引擎如何管理内存?</p></blockquote> <ul><li>内存生命周期</li></ul> <p>分配小内存空间，得到它的使用权</p> <p>存储数据，可以反复进行操作</p> <p>释放小内存空间</p> <ul><li>释放内存</li></ul> <p>局部变量：函数执行完自动释放</p> <p>对象：成为垃圾对象  =&gt;  垃圾回收器回收</p> <blockquote><p><strong>如何访问对象内部数据?</strong></p></blockquote> <p>object.属性名：编码简单，有时不能用</p> <p>object[ '属性名' ]：编码麻烦，能通用</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">&quot;猪八戒&quot;</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>name<span class="token punctuation">,</span> obj<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//猪八戒 猪八戒</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><blockquote><p><strong>访问对象内部数据什么时候必须使用  [ '属性名' ]  的方式?</strong></p></blockquote> <p><strong>(1) 属性名包含特殊字符：-  和  空格</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> o <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
o<span class="token punctuation">[</span>content<span class="token operator">-</span>type<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'text/json'</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>o<span class="token punctuation">[</span>content<span class="token operator">-</span>type<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>(2) 属性名不确定（属性名用变量保存）</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> o <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">&quot;type&quot;</span><span class="token punctuation">;</span>
o<span class="token punctuation">[</span>type<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'json'</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>o<span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><blockquote><p>如何定义及调用(执行)函数?</p></blockquote> <p>定义函数</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//函数声明</span>
<span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> <span class="token operator">...</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token comment">//表达式</span>
<span class="token keyword">var</span> <span class="token function-variable function">fn</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> <span class="token operator">...</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>调用函数</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//直接调用</span>
<span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//通过对象调用</span>
obj<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//作为构造函数由 new 调用</span>
<span class="token keyword">new</span> <span class="token class-name">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//临时让test成为obj的方法进行调用</span>
test<span class="token punctuation">.</span>call<span class="token operator">/</span><span class="token function">apply</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><blockquote><p>JavaScript 要不要加分号</p></blockquote> <p>一行开头是小括号 () 或者方括号 [] 的时候，在括号前面加上分号就可以了，其他时候全部不需要。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//小括号</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">0</span>
<span class="token punctuation">;</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;aaa&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">//方括号</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token number">0</span>
<span class="token punctuation">;</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;ooo&quot;</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token comment">//1  &quot;ooo&quot;  7</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="_3-函数及this"><a href="#_3-函数及this" class="header-anchor">#</a> 3.函数及this</h3> <blockquote><p><strong>回调函数</strong></p></blockquote> <p>将函数 A 作为参数传递给函数 B 执行，A 就是回调函数。</p> <p>(1) 你定义的； (2) 你没有调；(3)但最终它执行了。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> box <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;box&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
box<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;我是dom事件回调函数！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><blockquote><p><strong>常见的回调函数</strong></p></blockquote> <p>DOM 事件回调函数，定时器回调函数，Ajax请求回调函数，生命周期回调函数。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> box <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;box&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
box<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;我是dom事件回调函数！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;我是定时器回调函数！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><blockquote><p><strong>回调函数的 this 指谁？</strong></p></blockquote> <p>DOM事件回调函数 ==&gt; 发生事件的DOM元素</p> <p>定时器回调函数 ==&gt; window</p> <blockquote><p><strong>IIFE，立即执行函数</strong></p></blockquote> <p>全称：Immediately-Invoked Function Expression</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//匿名函数自调用</span>
<span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;我是立即执行函数！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>作用：隐藏实现，不会污染全局命名空间</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//隐藏实现</span>
<span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">90</span><span class="token punctuation">;</span> <span class="token comment">//局部变量</span>
    <span class="token function">alert</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//外部实现</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">90</span><span class="token punctuation">;</span>
<span class="token function">alert</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>IIFE最终用来写模块</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token operator">++</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">function</span> <span class="token function">test2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'test2()'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token comment">//向外暴露一个全局函数test</span>
    window<span class="token punctuation">.</span><span class="token function-variable function">$</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> 
        <span class="token comment">//返回一个对象{test: test}</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token literal-property property">test</span><span class="token operator">:</span> test<span class="token punctuation">}</span><span class="token punctuation">;</span> 
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">//$().test();</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//obj === {test: test}</span>
obj<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">i</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> 
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span> <span class="token comment">//7</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><blockquote><p><strong>函数中的 this</strong></p></blockquote> <p>任何函数本质上都是通过某个对象来调用的，如果没有直接指定就是window。所有函数内部都有一个变量this，它的值是调用函数的当前对象。this的情况：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//window</span>
p<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//p</span>
<span class="token keyword">new</span> <span class="token class-name">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//新创建的对象</span>
p<span class="token punctuation">.</span>call<span class="token operator">/</span><span class="token function">apply</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//obj</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="_4-原型及原型链"><a href="#_4-原型及原型链" class="header-anchor">#</a> 4.原型及原型链</h3> <blockquote><p>函数的prototype属性</p></blockquote> <p>每个函数都有一个 <strong>prototype</strong> 属性，它默认指向一个 Object 空对象(没有我们的属性)，该对象称为：<strong>原型对象</strong>。原型对象中有一个属性 <strong>constructor</strong>，它<strong>指向函数对象</strong>。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;gg&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//fun的prototype属性</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>fun<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span> <span class="token comment">//包含constructor属性</span>

<span class="token comment">//原型对象中有一个属性constructor,它指向函数对象</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>fun<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">===</span> fun<span class="token punctuation">)</span> <span class="token comment">//true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><blockquote><p>原型与原型对象</p></blockquote> <p><strong>原型</strong>(prototype)是函数的一个属性，这个属性是个指针指向原型对象。</p> <p><strong>原型对象</strong>(prototype object)是一个属于其所在函数的空对象，可以通过它给函数添加属性和方法。值得注意的是原型对象也拥有一个属性——constructor指向其函数。</p> <blockquote><p>给原型对象添加属性(一般都是方法)</p></blockquote> <p>作用：函数的所有实例对象自动拥有原型中的属性(方法)</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//给原型对象添加属性(一般是方法)===&gt;实例对象可以访问</span>
fun<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">test</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	console<span class="token punctuation">.</span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'test()'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><blockquote><p>显式原型和隐式原型</p></blockquote> <p>每个函数 function 都有一个 <strong>prototype</strong> 属性，即显式原型属性，默认指向一个空的Object对象，即<strong>指向原型对象</strong>。</p> <p>每个实例对象都有一个 <strong>_<em>proto</em>_</strong>，可称为隐式原型(属性)，也指向<strong>指向原型对象</strong>。</p> <p>对象的隐式原型的值为其对应构造函数的显式原型的值，两者都是<strong>引用变量</strong>，<strong>保存同一个原型对象的地址值</strong>。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//【1. 定义构造函数】</span>
<span class="token keyword">function</span> <span class="token constant">P</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">//内部语句: this.prototype = {}</span>

<span class="token punctuation">}</span> 

<span class="token comment">//内部语句: this._proto__ = Fn.prototype ，this 指向实例对象</span>
<span class="token comment">//【2. 创建实例对象】</span>
<span class="token keyword">var</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">P</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">//显式原型</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">P</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span>

<span class="token comment">//隐式原型</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>__proto__<span class="token punctuation">)</span> 

<span class="token comment">//两者指向同一个原型对象</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">P</span><span class="token punctuation">.</span>prototype <span class="token operator">===</span> p<span class="token punctuation">.</span>__proto__<span class="token punctuation">)</span> <span class="token comment">//true</span>

<span class="token comment">//【3.给原型对象添加方法】</span>
<span class="token class-name">P</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">test</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  
<span class="token punctuation">}</span>

<span class="token comment">//【4. 通过实例调用原型对象的方法】</span>
p<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p><strong>ES6之前</strong>，程序员能直接操作显式原型，但不能直接操作隐式原型。</p> <p>内存结构：左栈右堆</p> <img src="/assets/img/1.af0533b0.png" align="center"> <blockquote><p><strong>原型链</strong></p></blockquote> <p>访问一个<strong>对象</strong>的属性时，先在自身属性中查找，找到返回；如果没有，再<strong>沿着__proto__这条链</strong>向上查找，找到返回；直到找到 <strong>Object.prototype(null，Object的原型，原型链尽头)</strong> ，如果最终没找到，返回 undefined  。</p> <p>别名：<strong>隐式原型链</strong>，沿着隐式原型链查找。</p> <p>作用：查找对象的属性(方法)。</p> <blockquote><p><strong>图解原型链</strong></p></blockquote> <p>原型链图示：左栈右堆</p> <img src="/assets/img/2.1307b1f1.png" align="center"> <p>构造函数/原型/实例对象的关系1：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> o1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> o2 <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><img src="/assets/img/3.21d60f13.png" align="center"> <p>构造函数/原型/实例对象的关系2：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">var</span> Foo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Function</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">//所有函数的__proto__都是一样的</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><img src="/assets/img/4-2.c9e18d77.png" align="center"> <blockquote><p>各种原型链</p></blockquote> <p>函数的显式原型指向的对象默认是空Object实例对象(但Object不满足)。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Fn</span><span class="token punctuation">.</span>prototype <span class="token keyword">instanceof</span> <span class="token class-name">Object</span><span class="token punctuation">)</span> <span class="token comment">//true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">.</span>prototype <span class="token keyword">instanceof</span> <span class="token class-name">Object</span><span class="token punctuation">)</span><span class="token comment">//false</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Function</span><span class="token punctuation">.</span>prototype <span class="token keyword">instanceof</span> <span class="token class-name">Object</span><span class="token punctuation">)</span><span class="token comment">//true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span> <span class="token comment">//null</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>所有函数都是Function的实例 ( 包括Function() )。</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//内部语句</span>
<span class="token comment">//Function = new Function()</span>

<span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> <span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span>  <span class="token comment">//true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>Object的原型对象是原型链尽头</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>__proto__<span class="token punctuation">)</span> <span class="token comment">//null </span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>对象原型链(隐式原型链)</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//原型链上各个节点都是对象，有__proto__属性</span>
o <span class="token operator">--</span>__Proto__<span class="token operator">--</span><span class="token operator">&gt;</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype <span class="token operator">--</span>__Proto__<span class="token operator">--</span><span class="token operator">&gt;</span> <span class="token keyword">null</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>数组原型链(隐式原型链)</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//原型链上各个节点都是对象</span>
arr <span class="token operator">--</span>__Proto__<span class="token operator">--</span><span class="token operator">&gt;</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype <span class="token operator">--</span>__Proto__<span class="token operator">--</span><span class="token operator">&gt;</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype <span class="token operator">--</span>__Proto__<span class="token operator">--</span><span class="token operator">&gt;</span> <span class="token keyword">null</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>函数原型链(隐式原型链)</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//原型链上各个节点都是对象</span>
func <span class="token operator">--</span>__Proto__<span class="token operator">--</span><span class="token operator">&gt;</span> <span class="token class-name">Function</span><span class="token punctuation">.</span>prototype <span class="token operator">--</span>__Proto__<span class="token operator">--</span><span class="token operator">&gt;</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype <span class="token operator">--</span>__Proto__<span class="token operator">--</span><span class="token operator">&gt;</span> <span class="token keyword">null</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><blockquote><p>原型继承</p></blockquote> <p>构造函数的实例对象自动拥有构造函数原型对象的属性(方法)，利用的就是原型链。</p> <p><strong>读取</strong>对象的属性值时：会自动到原型链中查找。</p> <p><strong>设置</strong>对象的属性值时：不会查找原型链，如果当前对象中没有此属性，直接添加此属性并设置其值。</p> <p><strong>方法一般定义在原型中，属性一般通过构造函数定义在对象本身上。</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token comment">//创建实例</span>
o <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">//给原型对象添加方法，推荐</span>
<span class="token class-name">Fn</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">setAge</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">age</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">}</span>
<span class="token comment">//调用原型对象的方法</span>
o<span class="token punctuation">.</span><span class="token function">setAge</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>o<span class="token punctuation">.</span>age<span class="token punctuation">)</span> <span class="token comment">//18</span>

<span class="token comment">//给原型对象添加属性，不推荐</span>
<span class="token class-name">Fn</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">10</span>
<span class="token comment">//推荐</span>
o<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;ooo&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><blockquote><p><strong>探索 instanceof</strong></p></blockquote> <p>**问题：**instanceof 是如何判断的?</p> <p><strong>表达式：A  instanceof  B，如果 B 函数的显式原型对象在A对象的原型链(隐式原型链)上，返回true，否则返回false 。</strong></p> <ul><li>案例1：</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//表达式：A  instanceof  B</span>
<span class="token comment">//如果 B 函数的显式原型对象在A对象的原型链(隐式原型链)上，返回true，否则返回false </span>
<span class="token keyword">function</span> <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token punctuation">}</span>
<span class="token keyword">var</span> f1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>f1 <span class="token keyword">instanceof</span> <span class="token class-name">Foo</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>f1 <span class="token keyword">instanceof</span> <span class="token class-name">Object</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><img src="/assets/img/5.88ebde62.png" align="center"> <ul><li>案例2：</li></ul> <p>Function是通过  new自己  产生的实例。所有函数都是Function的实例 ( 包括Function() )。函数的显式原型指向的对象默认是空Object实例对象(但Object()不满足)。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//表达式：A  instanceof  B</span>
<span class="token comment">//如果 B 函数的显式原型对象在A对象的原型链(原型链==隐式原型链)上，返回true，否则返回false </span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object <span class="token keyword">instanceof</span> <span class="token class-name">Function</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object <span class="token keyword">instanceof</span> <span class="token class-name">Object</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Function <span class="token keyword">instanceof</span> <span class="token class-name">Function</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Function <span class="token keyword">instanceof</span> <span class="token class-name">Object</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//true</span>

<span class="token keyword">function</span> <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object <span class="token keyword">instanceof</span> <span class="token class-name">Foo</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//false</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><img src="/assets/img/6.bb482780.png" align="center"> <blockquote><p>测试题</p></blockquote> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token constant">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  
<span class="token punctuation">}</span>
<span class="token class-name">A</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>n <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token class-name">A</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token literal-property property">n</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
	<span class="token literal-property property">m</span><span class="token operator">:</span> <span class="token number">3</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>n<span class="token punctuation">,</span> b<span class="token punctuation">.</span>m<span class="token punctuation">,</span> c<span class="token punctuation">.</span>n<span class="token punctuation">,</span> c<span class="token punctuation">.</span>m<span class="token punctuation">)</span>  <span class="token comment">//1 undefined 2 3</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><strong>显式原型(prototype)和隐式原型(<strong>proto</strong>)都是引用变量，保存同一个原型对象的地址值</strong>。</p> <img src="/assets/img/7.065ec223.png" align="center"> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">F</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">a</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'a()'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">b</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'b()'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> f <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
f<span class="token punctuation">.</span><span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">//a()</span>
f<span class="token punctuation">.</span><span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">//error</span>
<span class="token constant">F</span><span class="token punctuation">.</span><span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">//a()</span>
<span class="token constant">F</span><span class="token punctuation">.</span><span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">//b()</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>运用原型链解决。</p> <h3 id="_5-执行上下文与执行上下文栈"><a href="#_5-执行上下文与执行上下文栈" class="header-anchor">#</a> 5.执行上下文与执行上下文栈</h3> <blockquote><p>变量提升和函数提升</p></blockquote> <p>变量声明提升：通过 <strong>var定义(声明)</strong> 的变量，在定义语句之前就可以访问到，值：undefined，<strong>相当于定义未赋值就使用</strong>。</p> <p>函数声明提升：通过<strong>function声明</strong>的函数，在之前就可以直接调用，值：函数定义(对象)。<strong>通过var声明的函数不会提升，这相当于变量提升，使用前还没有赋值，无法调用</strong>。</p> <p>问题：变量提升和函数提升是如何产生的?</p> <p>因为：执行代码前要做数据预处理。</p> <blockquote><p>执行上下文</p></blockquote> <ul><li><p>代码分类(位置)</p> <p>全局代码</p> <p>函数(局部)代码</p></li> <li><p>全局执行上下文</p> <p>在执行全局代码前将window确定为全局执行上下文。</p> <p>对全局数据进斯预处理：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>var定义的全局变量 ==&gt; undefined，添加为window的属性；

function声明的全局函数 ==&gt; 赋值(fun)，添加为window的方法；

this ==&gt; 赋值(window)；
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>开始执行全局代码。</p></li> <li><p>函数执行上下文</p> <p>在<strong>调用函数</strong>，准备执行函数体之前，创建对应的<strong>函数执行上下文对象（虚拟对象，存于栈中）</strong>。</p> <p>对局部数据进行<strong>预处理</strong>：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>形参变量 ==&gt; 赋值(实参) ==&gt; 添加为函数执行上下文的属性；

arguments ==&gt; 赋值(实参列表)，添加为函数执行上下文的属性；

var定义的局部变量 ==&gt; undefined，添加为函数执行上下文的属性；

function声明的函数 ==&gt; 赋值(fun)，添加为函数执行上下文的方法

this ==&gt; 赋值(调用函数的对象)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>开始执行函数体代码。</p></li></ul> <blockquote><p>执行上下文栈</p></blockquote> <p>在全局代码执行前，JS引擎就会创建一个栈来存储管理所有的执行上下文对象；</p> <p>在全局执行上下文(window)确定后，将其添加到栈中(压栈)；</p> <p>在函数执行上下文创建后，将其添加到栈中(压栈)；</p> <p>在当前函数执行完后，将栈顶的对象移除(出栈)；</p> <p>当所有的代码执行完后，栈中只剩下window。</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!--
	调用一次函数创建一次函数执行上下文
--&gt;</span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/javascript<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
								<span class="token comment">//1．进入全局执行上下文</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">10</span>
<span class="token keyword">var</span> <span class="token function-variable function">bar</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token number">5</span>
    <span class="token function">foo</span><span class="token punctuation">(</span>x <span class="token operator">+</span> b<span class="token punctuation">)</span>				 <span class="token comment">//3．进入foo函数执行上下文</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> <span class="token function-variable function">foo</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">y</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token number">5</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a <span class="token operator">+</span> c <span class="token operator">+</span> y<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">bar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>						<span class="token comment">//2.进入bar函数执行上下文</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>执行流程分析：</p> <img src="data:image/png;base64,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" align="center"> <blockquote><p>测试题</p></blockquote> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//测试题1∶先执行变量提升，再执行函数提升</span>
<span class="token keyword">function</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">var</span> a
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> a<span class="token punctuation">)</span> <span class="token comment">//'function'</span>

<span class="token comment">//测试题2</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>b <span class="token keyword">in</span> window<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token number">1</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token comment">//undefined</span>

<span class="token comment">//测试题3</span>
<span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">function</span> <span class="token function">c</span><span class="token punctuation">(</span><span class="token parameter">c</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> 
<span class="token punctuation">}</span>
<span class="token function">c</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">//报错</span>
<span class="token comment">//相当于</span>
<span class="token keyword">var</span> c
<span class="token keyword">function</span> <span class="token function">c</span><span class="token punctuation">(</span><span class="token parameter">c</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> 
<span class="token punctuation">}</span>
c <span class="token operator">=</span> <span class="token number">1</span> <span class="token comment">//c是变量了</span>
<span class="token function">c</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">//报错</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>测试题3解析：<strong>函数提升优先级高于变量提升，且不会被同名变量声明覆盖，但是会被变量赋值后覆盖。而且存在同名函数与同名变量时，优先执行函数。</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">//f a()</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">//1  </span>
<span class="token keyword">var</span> a<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">//1   </span>
a<span class="token operator">=</span><span class="token number">3</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>      <span class="token comment">//a not a function</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>它的过程就相当于</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">a</span><span class="token operator">=</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>   <span class="token comment">//声明一个变量a指向</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> a<span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>  	<span class="token comment">//如果a不优先执行含函数，这里是返回undefined;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
a<span class="token operator">=</span><span class="token number">1</span>    				<span class="token comment">//这里函数与变量</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
a<span class="token operator">=</span><span class="token number">3</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>函数提升优先级高于变量提升，且不会被同名变量声明覆盖，<strong>但是会被变量赋值后覆盖。</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">var</span> a
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> a<span class="token punctuation">)</span><span class="token comment">//function</span>

<span class="token keyword">var</span> b
<span class="token keyword">function</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> b<span class="token punctuation">)</span><span class="token comment">//function</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> a<span class="token punctuation">)</span><span class="token comment">//function</span>
<span class="token keyword">function</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> a<span class="token punctuation">)</span> <span class="token comment">//number</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> b<span class="token punctuation">)</span><span class="token comment">//function</span>
<span class="token keyword">var</span> b<span class="token operator">=</span><span class="token number">1</span>
<span class="token keyword">function</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> b<span class="token punctuation">)</span> <span class="token comment">//number</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h3 id="_6-作用域与作用域链"><a href="#_6-作用域与作用域链" class="header-anchor">#</a> 6.作用域与作用域链</h3> <blockquote><p>作用域分类</p></blockquote> <p>全局作用域</p> <p>函数作用域</p> <p>没有块作用域(ES6有了)</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
	<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">0</span>  <span class="token comment">//全局</span>
	<span class="token keyword">function</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token number">0</span>  <span class="token comment">//局部</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token number">10</span> <span class="token comment">//没有块作用域</span>
    <span class="token punctuation">}</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token comment">//10</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><img src="/assets/img/10.9c1bacfc.png" align="center"> <blockquote><p>作用域与执行上下文</p></blockquote> <ul><li>区别1</li></ul> <p>全局作用域之外，每个函数都会创建自己的作用艰，作用域在函数定义时就已经确定了。而不是在函数调用时；</p> <p>全局执行上下文环境是在全局作用域确定之后，js代码马上执行之前创建；</p> <p>函数执行上下文环境是在调用函数时，函数体代码执行之前创建。</p> <ul><li>区别2</li></ul> <p>作用域是静态的，只要函数定义好了就一直存在，且不会再变化；</p> <p>执行上下文是动态的，调用函数时创建，函数调用结束时执行上下文就会被释放。</p> <ul><li>联系</li></ul> <p>执行上下文(对象)是从属于所在的作用域</p> <p>全局执行上下文 ==&gt; 全局作用域</p> <p>函数执行上下文 ==&gt; 对应的函数使用域</p> <img src="data:image/png;base64,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" align="center"> <blockquote><p>作用域链</p></blockquote> <ul><li>理解</li></ul> <p>多个上下级关系的作用域形成的链，它的方向是从下向上的(从内到外)。<strong>查找变量时</strong>就是沿着<strong>作用域链</strong>来查找的。<strong>查找对象属性</strong>沿着<strong>原型链</strong>找。</p> <ul><li>查找一个变量的查找规则</li></ul> <p>在当前作用域下的执行上下文中查找对应的属性，如果有直接返回， 否则进入2</p> <p>在上一级作用域的执行上下文中查找对应的属性，如果有直接返回，否则进入3</p> <p>再次执行2的相同操作，直到全局作用域，如果还找不到就抛出找不到的异常。</p> <img src="/assets/img/12.b82e860a.png" align="center"> <blockquote><p>测试题</p></blockquote> <p><strong>作用域是静态的，定义函数时就已经确定，不会因为在别的作用域调用函数发生改变。</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//1. 作用域是静态的，定义函数时就已经确定，不会发生改变</span>
<span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">show</span><span class="token punctuation">(</span><span class="token parameter">f</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
    <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">//f()有自己的作用域，不在show里面</span>
<span class="token punctuation">}</span>
<span class="token function">show</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span> <span class="token comment">//10</span>

<span class="token comment">//2.修改1</span>
		<span class="token comment">//修改</span>
<span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">show</span><span class="token punctuation">(</span><span class="token parameter">f</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
    <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">//f()有自己的作用域，不在show里面</span>
<span class="token punctuation">}</span>
<span class="token function">show</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span> <span class="token comment">//报错</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//3.</span>
<span class="token keyword">var</span> <span class="token function-variable function">fn</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">//function () {console.log(fn)}</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">fn2</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>fn2<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
obj<span class="token punctuation">.</span><span class="token function">fn2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">//报错，先在自己的作用域找，再到全局作用域</span>

<span class="token comment">//4.修改3</span>
<span class="token keyword">var</span> <span class="token function-variable function">fn</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">//function () {console.log(fn)}</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">fn2</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>fn2<span class="token punctuation">)</span> <span class="token comment">//修改</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
obj<span class="token punctuation">.</span><span class="token function">fn2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">//报错，先在自己的作用域找，再到全局作用域</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h3 id="_7-闭包"><a href="#_7-闭包" class="header-anchor">#</a> 7.闭包</h3> <blockquote><p>循环遍历加监听</p></blockquote> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/javascript<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    window<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//需求: 点击某个按钮, 提示&quot;点击的是第n个按钮&quot;</span>
    
        <span class="token keyword">var</span> btns <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">&quot;button&quot;</span><span class="token punctuation">)</span>
        <span class="token comment">/*
        for(var i=0, len = btns.length;i&lt;len;i++){
            btns[i].onclick = function(){
                alert(&quot;第&quot;+(i+1)+&quot;个按钮&quot;)
            }
        }
        */</span>
        <span class="token comment">//上面点击每个按钮都是输出4，因为触发点击响应函数之前for循环早已执行完，i==3</span>
    
        <span class="token comment">//这样修改，利用属性</span>
        <span class="token comment">/*
        for(var i=0, len = btns.length;i&lt;len;i++){
            btns[i].num = i
            btns[i].onclick = function(){
                alert(&quot;第&quot;+(this.num+1)+&quot;个按钮&quot;)
            }
        }
        */</span>
    
        <span class="token comment">//利用闭包</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> len <span class="token operator">=</span> btns<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">&lt;</span>len<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">i</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                btns<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;第&quot;</span><span class="token operator">+</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;个按钮&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span><span class="token punctuation">&gt;</span></span>测试1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span><span class="token punctuation">&gt;</span></span>测试2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span><span class="token punctuation">&gt;</span></span>测试3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><blockquote><p>理解闭包</p></blockquote> <ol><li><p>什么是闭包？</p> <p><strong>闭包</strong>是指有权访问另一个函数作用域中的变量的函数。</p></li> <li><p>如何产生闭包?</p></li></ol> <p>当一个嵌套的内部(子)函数引用了嵌套的外部(父)函数的变量(函数)时，就产生了闭包。</p> <ol start="3"><li>闭包到底是什么?</li></ol> <p>使用chrome调试在sources查看</p> <ul><li>理解一：闭包是嵌套的内部函数(绝大部分人)，如f2</li> <li>理解二：包含被引用变量(函数)的对象(极少数人)</li></ul> <p>注意：闭包存在于嵌套的<strong>内部函数</strong>中</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> b<span class="token operator">=</span><span class="token number">9</span>
    <span class="token keyword">function</span> <span class="token function">f2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>   <span class="token comment">///执行函数定义就会产生闭包(不用调用内部函数)</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">//产生闭包f2</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ol start="4"><li>产生闭包的条件?</li></ol> <ul><li><strong>函数嵌套</strong></li> <li><strong>内部函数引用了外部函数的数据(变量)</strong></li></ul> <blockquote><p>常见的闭包</p></blockquote> <ul><li>将函数作为另一个函数的返回值（<strong>产生闭包的条件要满足</strong>）</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">fn1</span><span class="token punctuation">(</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">2</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        a<span class="token operator">++</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> f <span class="token operator">=</span> <span class="token function">fn1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">//整个过程只创建一个闭包</span>
<span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 3</span>
<span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 4</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><ul><li>将函数作为实参传递给另一个函数调用（<strong>产生闭包的条件要满足</strong>）</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">showDelay</span><span class="token punctuation">(</span><span class="token parameter">msg<span class="token punctuation">,</span> time</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token function">alert</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span>  <span class="token comment">//内部函数function() {alert(msg)}引用外部函数变量</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> time<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">showDelay</span><span class="token punctuation">(</span><span class="token string">'atguigu'</span>，<span class="token number">2000</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><blockquote><p>闭包的作用</p></blockquote> <ul><li>使用函数内部的变量在函数执行完后, 仍然存活在内存中(延长了局部变量的生命周期)</li> <li>让函数外部可以操作(读写)到函数内部的数据(变量/函数)</li> <li>问题:</li></ul> <ol><li><p>函数执行完后，函数内部声明的局部变量是否还存在?</p> <p>一般是不存在，存在于闭包中的变量才可能存在。</p></li> <li><p>在函数外部能直接访问函数内部的局部变量吗?</p> <p>不能，但通过闭包让外部操作它。</p></li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">fn1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> a<span class="token operator">=</span><span class="token number">2</span>
    <span class="token keyword">function</span> <span class="token function">fn2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        a<span class="token operator">++</span>
        console<span class="token punctuation">.</span><span class="token number">1</span><span class="token function">og</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> f<span class="token operator">=</span>fn1
<span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//3</span>
<span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//4</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><blockquote><p>闭包生命周期</p></blockquote> <p>产生：在嵌套内部函数定义执行完时就产生了(不是在调用)</p> <p>死亡：在嵌套的内部函数成为垃圾对象时</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">fn1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//此时闭包就已经产生了(函数提升，内部函数对象已经创建)</span>
    <span class="token keyword">var</span> a<span class="token operator">=</span><span class="token number">2</span>
    <span class="token keyword">function</span> <span class="token function">fn2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        a<span class="token operator">++</span>
        console<span class="token punctuation">.</span><span class="token number">1</span><span class="token function">og</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> f<span class="token operator">=</span><span class="token function">fn1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment">//3</span>
<span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment">//4</span>
f<span class="token operator">=</span><span class="token keyword">null</span> <span class="token comment">//闭包死亡(包含闭包的函数对象成为垃圾对象)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><blockquote><p>闭包的应用 --- 定义JS模块</p></blockquote> <p>JS模块：具有特定功能的js文件；<strong>将所有的数据和功能都封装在一个函数内部(私有的)；只向外暴露一个包含 n 个方法的对象或函数；模块的使用者, 只需要通过模块暴露的对象调用方法来实现对应的功能。</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">myModule</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//私有数据</span>
    <span class="token keyword">var</span> msg <span class="token operator">=</span> <span class="token string">&quot;hhhh&quot;</span>
    <span class="token comment">//操作数据的函数</span>
    <span class="token keyword">function</span> <span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        cosole<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>msg <span class="token operator">+</span> <span class="token string">&quot;ooo&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">function</span> <span class="token function">doOtherthing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        cosole<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>msg <span class="token operator">+</span> <span class="token string">&quot;bbb&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//向外暴露对象(给外部使用的方法)</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">doSomething</span><span class="token operator">:</span>doSomething<span class="token punctuation">,</span>
        <span class="token literal-property property">doOtherthing</span><span class="token operator">:</span>doOtherthing
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token function">myModule</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
obj<span class="token punctuation">.</span><span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token comment">//hhhooo</span>
obj<span class="token punctuation">.</span><span class="token function">doOtherthing</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">//hhhbbb</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>匿名函数自调用怎么样向外暴露对象？</p> <p>在函数内部把要暴露的对象或函数添加为 window 的属性。不需要执行外部函数。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">myModule</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//私有数据</span>
    <span class="token keyword">var</span> msg <span class="token operator">=</span> <span class="token string">&quot;hhhh&quot;</span>
    <span class="token comment">//操作数据的函数</span>
    <span class="token keyword">function</span> <span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        cosole<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>msg <span class="token operator">+</span> <span class="token string">&quot;ooo&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">function</span> <span class="token function">doOtherthing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        cosole<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>msg <span class="token operator">+</span> <span class="token string">&quot;bbb&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//向外暴露对象(给外部使用的方法)</span>
    window<span class="token punctuation">.</span>myModule<span class="token punctuation">{</span>
        <span class="token literal-property property">doSomething</span><span class="token operator">:</span>doSomething<span class="token punctuation">,</span>
        <span class="token literal-property property">doOtherthing</span><span class="token operator">:</span>doOtherthing
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><blockquote><p>闭包的缺点及解决</p></blockquote> <ul><li>缺点</li></ul> <p>函数执行完后，函数内的局部变量没有释放，占用内存时间会变长；容易造成内存泄露。</p> <ul><li>解决</li></ul> <p>能不用闭包就不用；及时释放。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span><span class="token number">100000</span><span class="token punctuation">)</span>
    <span class="token keyword">function</span> <span class="token function">f2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr<span class="token punctuation">.</span>length<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> f2
<span class="token punctuation">}</span>
<span class="token keyword">var</span> f <span class="token operator">=</span> <span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

f<span class="token operator">=</span><span class="token keyword">null</span> <span class="token comment">//让内部函数成为垃圾对象--&gt;回收闭包</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><blockquote><p>内存溢出与内存泄漏</p></blockquote> <ul><li>内存溢出</li></ul> <p>一种程序运行出现的错误，当程序运行需要的内存超过了剩余的内存时，就出抛出内存溢出的错误。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">10000</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    obj<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span><span class="token number">10000000000</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;----------------------------&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><img src="/assets/img/13.95ffe2b1.png" align="center"> <ul><li>内存泄露(程序还能运行)</li></ul> <p>占用的内存没有及时释放，内存泄露积累多了就容易<strong>导致内存溢出</strong>，常见的内存泄露：<strong>意外的全局变量、没有及时清理的计时器或回调函数、闭包没有回收等。</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//意外的全局变量</span>
<span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	a<span class="token operator">=</span><span class="token number">0</span>  <span class="token comment">//全局变量</span>
<span class="token punctuation">}</span>

<span class="token comment">//没有及时清理的计时器或回调函数</span>
<span class="token keyword">var</span> timer <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">//启动循环定时器后不清理</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;0000000&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//clearInterval (timer) //清除定时器</span>

<span class="token comment">//闭包没有回收</span>
<span class="token keyword">function</span> <span class="token function">fn1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">4</span>
    <span class="token keyword">function</span> <span class="token function">fn2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token number">1</span><span class="token function">og</span><span class="token punctuation">(</span><span class="token operator">++</span>a<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> fn2
<span class="token keyword">var</span> f <span class="token operator">=</span> <span class="token function">fn1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">//f=null //让内部函数成为垃圾对象--&gt;回收闭包</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><blockquote><p>测试题</p></blockquote> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//代码片段一</span>
<span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">&quot;The Window&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span> <span class="token operator">:</span> <span class="token string">&quot;My Object&quot;</span><span class="token punctuation">,</span>
    <span class="token function-variable function">getNameFunc</span> <span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token function">alert</span><span class="token punctuation">(</span>object<span class="token punctuation">.</span><span class="token function">getNameFunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//The Window</span>
<span class="token comment">//解释：调用object.getNameFunc()得到函数，直接调用，this是window；没有产生闭包，因为没有引用外部函数变量</span>


<span class="token comment">//代码片段二</span>
<span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">&quot;The Window&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span> <span class="token operator">:</span> <span class="token string">&quot;My Object&quot;</span><span class="token punctuation">,</span>
    <span class="token function-variable function">getNameFunc</span> <span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">var</span> that <span class="token operator">=</span> <span class="token keyword">this</span>   <span class="token comment">//this指向object</span>
        <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> that<span class="token punctuation">.</span>name<span class="token punctuation">;</span>  <span class="token comment">//that是外部函数的变量，指向object</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token function">alert</span><span class="token punctuation">(</span>object<span class="token punctuation">.</span><span class="token function">getNameFunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//My Object</span>

<span class="token comment">//代码片段三</span>
<span class="token keyword">function</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token parameter">n<span class="token punctuation">,</span>o</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token function-variable function">fun</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">m</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
            <span class="token keyword">return</span> <span class="token function">fun</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//调用第一层函数</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//undefined</span>
a<span class="token punctuation">.</span><span class="token function">fun</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//0</span>
a<span class="token punctuation">.</span><span class="token function">fun</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//0</span>
a<span class="token punctuation">.</span><span class="token function">fun</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//0</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fun</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fun</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fun</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//undefined,0,1,2</span>
<span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fun</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//undefined,0</span>
c<span class="token punctuation">.</span><span class="token function">fun</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//1</span>
c<span class="token punctuation">.</span><span class="token function">fun</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><blockquote><p>闭包与变量</p></blockquote> <p>作用域链的这种配置机制引出了一个值得注意的副作用，即闭包只能取得包含函数中任何变量的最后一个值。别忘了闭包所保存的是整个变量对象，而不是某个特殊的变量。下面这个例子可以清晰地说明这个问题。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">createFunctions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> 
    <span class="token keyword">var</span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span> 
        result<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">return</span> i<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> 
 	<span class="token punctuation">}</span> 
 	<span class="token keyword">return</span> result<span class="token punctuation">;</span> 
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>这个函数会返回一个函数数组。表面上看，似乎每个函数都应该返自己的索引值，即位置 0 的函数返回 0，位置 1 的函数返回 1，以此类推。但实际上，每个函数都返回 10。因为每个函数的作用域链中都保存着 createFunctions() 函数的活动对象，所以它们引用的都是同一个变量 i 。 当createFunctions()函数返回后，变量 i 的值是 10，此时每个函数都引用着保存变量 i 的同一个变量对象，所以在每个函数内部 i 的值都是 10。但是，我们可以通过创建另一个匿名函数强制让闭包的行为符合预期，如下所示。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">createFunctions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> 
    <span class="token keyword">var</span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span> 
        result<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">num</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token comment">//立即执行函数</span>
            <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token comment">//闭包，引用num</span>
                <span class="token keyword">return</span> num<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span> 
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//立即执行函数，i传给num</span>
 	<span class="token punctuation">}</span> 
 	<span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>在重写了前面的 createFunctions()函数后，每个函数就会返回各自不同的索引值了。在这个版本中，我们没有直接把闭包赋值给数组，而是定义了一个匿名函数，并将立即执行该匿名函数的结果赋给数组。这里的匿名函数有一个参数 num，也就是最终的函数要返回的值。在调用每个匿名函数时，我们传入了变量 i。由于函数参数是按值传递的，所以就会将变量 i 的当前值复制给参数 num。而在这个匿名函数内部，又创建并返回了一个访问 num 的闭包。这样一来，result 数组中的每个函数都有自己 num 变量的一个副本，因此就可以返回各自不同的数值了。</p> <h3 id="_8-对象创建模式"><a href="#_8-对象创建模式" class="header-anchor">#</a> 8.对象创建模式</h3> <blockquote><p>Object构造函数模式</p></blockquote> <p>创建方法：先创建空Object对象，再动态添加属性/方法。</p> <p>适用场景：起始时不确定对象内部数据。</p> <p>引出问题：语句太多。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
obj<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;lll&quot;</span>
obj<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">0</span>
obj<span class="token punctuation">.</span><span class="token function-variable function">setName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><blockquote><p>对象字面量模式</p></blockquote> <p>创建方法：使用{}创建对象，同时指定属性/方法。</p> <p>适用场景：起始时对象内部数据是确定的。</p> <p>引出问题：如果创建多个对象，有重复代码。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token literal-property property">name</span> <span class="token operator">:</span> <span class="token string">&quot;lll&quot;</span><span class="token punctuation">,</span>
	<span class="token literal-property property">age</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
 	<span class="token function-variable function">setName</span> <span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    	<span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><blockquote><p>工厂模式</p></blockquote> <p>创建方法：通过工厂函数动态创建对象并返回。</p> <p>适用场景：需要创建多个对象。</p> <p>引出问题：对象没有一个<strong>具体的类型</strong>，都是Object类型。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//返回一个对象的函数===&gt;工厂函数</span>
<span class="token keyword">function</span> <span class="token function">createPerson</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> fun</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">name</span><span class="token operator">:</span>name<span class="token punctuation">,</span>
        <span class="token literal-property property">age</span><span class="token operator">:</span>age<span class="token punctuation">,</span>
        <span class="token literal-property property">sayName</span><span class="token operator">:</span>fun
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> obj
<span class="token punctuation">}</span>
<span class="token keyword">var</span> obj1 <span class="token operator">=</span> <span class="token function">createPerson</span><span class="token punctuation">(</span><span class="token string">&quot;lll&quot;</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> obj2 <span class="token operator">=</span> <span class="token function">createPerson</span><span class="token punctuation">(</span><span class="token string">&quot;hhh&quot;</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><blockquote><p>自定义构造函数模式</p></blockquote> <p>创建方法：自定义构造函数，通过new创建对象。</p> <p>适用场景：需要创建多个类型确定的对象。</p> <p>引出问题：每个对象都有相同的数据，浪费内存。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//构造函数1</span>
<span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> gender</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>gender <span class="token operator">=</span> gender<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">sayName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">/*
所有实例的sayName方法都是唯一的;
上面构造函数有问题，调用一次构造函数就创建一个新的方法，调1000000次建1000000次，占用内存;
*/</span>
<span class="token keyword">var</span> p1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;ppp&quot;</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">&quot;男&quot;</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p1 <span class="token keyword">instanceof</span> <span class="token class-name">Person</span><span class="token punctuation">)</span> <span class="token comment">//true</span>


<span class="token comment">//构造函数2</span>
<span class="token keyword">function</span> <span class="token function">Student</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> gender</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>gender <span class="token operator">=</span> gender<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">sayName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> p2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">&quot;ppp&quot;</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">&quot;男&quot;</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p2 <span class="token keyword">instanceof</span> <span class="token class-name">Student</span><span class="token punctuation">)</span> <span class="token comment">//true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><blockquote><p>构造函数+原型的组合模式</p></blockquote> <p>创建方法：自定义构造函数，属性在函数中初始化，方法添加到原型上。</p> <p>适用场景：需要创建多个类型确定的对象。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> gender</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>gender <span class="token operator">=</span> gender<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> per1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'zz'</span><span class="token punctuation">,</span> <span class="token string">'male'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> per2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'zzi'</span><span class="token punctuation">,</span> <span class="token string">'male'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">sayName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//去原型找</span>
per1<span class="token punctuation">.</span><span class="token function">sayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//zz</span>
per2<span class="token punctuation">.</span><span class="token function">sayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//zzi</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="_9-继承模式"><a href="#_9-继承模式" class="header-anchor">#</a> 9.继承模式</h3> <blockquote><p>原型链继承</p></blockquote> <ul><li><p>方法</p> <p>（1）定义父类型构造函数</p> <p>（2）给父类型的原型添加方法</p> <p>（3）定义子类型的构造函数</p> <p>（4）<strong>创建父类型的对象赋值给子类型的原型</strong></p> <p>（5）<strong>将子类型原型的构造属性 constructor 设置为子类型</strong></p> <p>（6）给子类型原型添加方法</p> <p>（7）创建子类型的对象：可以调用父类型的方法</p></li> <li><p>关键</p> <p><strong>子类型的原型为父类型的一个实例对象</strong></p></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//父类型</span>
<span class="token keyword">function</span> <span class="token function">Supper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>supProp <span class="token operator">=</span> <span class="token string">&quot;Supper&quot;</span>
<span class="token punctuation">}</span>
<span class="token comment">//给父类型原型添加方法</span>
<span class="token class-name">Supper</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">showSupperProp</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token number">1</span><span class="token function">og</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>supProp<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">//子类型</span>
<span class="token keyword">function</span> <span class="token function">Sub</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>subProp <span class="token operator">=</span><span class="token string">'Sub'</span>
<span class="token punctuation">}</span>

<span class="token comment">//子类型的原型为父类型的一个实例对象</span>
<span class="token class-name">Sub</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Supper</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">//让子类型的原型的constructor指向子类型</span>
<span class="token class-name">Sub</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> Sub


<span class="token comment">//给子类型原型添加方法</span>
<span class="token class-name">Sub</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">showSubProp</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>subProp<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> sub <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Sub</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">//尝试使用Supper原型的方法</span>
sub<span class="token punctuation">.</span><span class="token function">showSupperProp</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><ul><li>图解</li></ul> <img src="/assets/img/14.77347379.png" align="center"> <blockquote><p>借用构造函数继承(假的)</p></blockquote> <ul><li><p>方法</p> <p>（1） 定义父类型构造函数</p> <p>（2）定义子类型构造函数</p> <p>（3）在子类型构造函数中调用父类型构造</p></li> <li><p>关键</p></li></ul> <p>在子类型构造函数中通用 Super() 调用父类型构造函数</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token parameter">name，age</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">Student</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> price</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">Person</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> age<span class="token punctuation">)</span> <span class="token comment">// 相当于: this. Person(name, age)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>price <span class="token operator">=</span> price
<span class="token punctuation">}</span>
<span class="token keyword">var</span> s<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">'Tom'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">1400</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>name<span class="token punctuation">,</span> s<span class="token punctuation">.</span>age<span class="token punctuation">,</span> s<span class="token punctuation">.</span>price<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><blockquote><p>组合继承</p></blockquote> <ul><li><p>原型链+借用构造函数的组合继承(假继承)：</p> <p>利用原型链实现对父类型对象的方法继承；</p> <p>利用call()借用父类型构建函数初始化相同属性。</p></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token parameter">name，age</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age
<span class="token punctuation">}</span>

Person<span class="token punctuation">.</span> prototype<span class="token punctuation">.</span> <span class="token function-variable function">setName</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span> name <span class="token operator">=</span> name
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">Student</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> price</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">Person</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> age<span class="token punctuation">)</span> <span class="token comment">// 相当于: this. Person(name, age)，为了得到属性</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>price <span class="token operator">=</span> price
<span class="token punctuation">}</span>
<span class="token class-name">Student</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//为了能看到父类型的方法</span>
<span class="token class-name">Student</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> Student <span class="token comment">//修正constructor属性</span>
<span class="token class-name">Student</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">setPrice</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">price</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>price <span class="token operator">=</span> price
<span class="token punctuation">}</span>

<span class="token keyword">var</span> s<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">'Tom'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">1400</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>name<span class="token punctuation">,</span> s<span class="token punctuation">.</span>age<span class="token punctuation">,</span> s<span class="token punctuation">.</span>price<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="_10-线程机制与事件机制"><a href="#_10-线程机制与事件机制" class="header-anchor">#</a> 10.线程机制与事件机制</h3> <blockquote><p>进程与线程</p></blockquote> <ul><li><p>进程(process)</p> <p>程序的一次执行，它占有一片独有的内存空间。可以通过windows任务管理器查看进程。</p></li> <li><p>线程(thread)</p> <p>是进程内的一个独立执行单元，是程序执行的一个完整流程，是CPU的最小的调度单元。</p></li> <li><p>图解</p></li></ul> <img src="/assets/img/15.59491412.png" align="center"> <ul><li><p>相关知识</p> <p>应用程序必须运行在某个进程的某个线程上；</p> <p>一个进程中至少有一个运行的线程：主线程，进程启动后自动创建；</p> <p>一个进程中也可以同时运行多个线程，我们会说程序是多线程运行的；</p> <p>一个进程内的数据可以供其中的多个线程直接共享；</p> <p>多个进程之间的数据是不能直接共享的；</p> <p>线程池(thread pool)：保存多个线程对象的容器，实现线程对象的反复利用。</p></li> <li><p>相关问题</p> <ul><li><p>何为多进程与多线程?</p> <p>多进程运行：一应用程序可以同时启动多个实例运行。</p> <p>多线程：在同一个进程内，同时有多个线程运行。</p></li> <li><p>比较单线程与多线程?</p> <p>多线程：优点：能有效提升CPU的利用率。缺点：创建多线程开销、线程间切换开销、死锁与状态同步问题。</p> <p>单线程：优点：顺序编程简单易懂。缺点：效率低。</p></li> <li><p>JS是单线程还是多线程?</p> <p>js是单线程运行的，但使用H5中的 Web Workers可以多线程运行。</p></li> <li><p>浏览器运行是单线程还是多线程?</p> <p>都是多线程运行的。</p></li> <li><p>浏览器运行是单进程还是多进程?</p> <p>有的是单进程，firefox、老版IE。有的是多进程，chrome、新版IE。</p></li> <li><p>如何查看浏览器是否是多进程运行的呢?</p> <p>任务管理器  ==&gt; 进程</p></li></ul></li></ul> <blockquote><p>浏览器内核</p></blockquote> <ul><li><p>支撑浏览器运行的最核心的程序</p></li> <li><p>不同的浏览器可能不一样，Chrome, Safari : webkit，firefox : Gecko，IE	: Trident，360,搜狗等国内浏览器: Trident + webkit</p></li> <li><p>内核由很多模块组成</p> <ul><li><p>主线程</p> <p>js引擎模块 : 负责js程序的编译与运行</p> <p>html,css文档解析模块 : 负责页面文本的解析</p> <p>DOM/CSS模块 : 负责dom/css在内存中的相关处理</p> <p>布局和渲染模块 : 负责页面的布局和效果的绘制(内存中的对象)
......</p></li> <li><p>分线程</p> <p>定时器模块 : 负责定时器的管理</p> <p>DOM事件响应模块 : 负责事件的管理</p> <p>网络请求模块 : 负责ajax请求</p></li></ul></li></ul> <blockquote><p>定时器引发的思考</p></blockquote> <ul><li><p>定时器真是定时执行的吗?</p> <p>定时器并不能保证真正定时执行，一般会延迟一丁点(可以接受)，也有可能延迟很长时间(不能接受)。</p></li> <li><p>定时器回调函数是在哪个线程执行的?</p> <p>在主线程执行的，js是单线程的。</p></li> <li><p>定时器是如何实现的?</p> <p>事件循环模型。</p></li></ul> <blockquote><p>JS是单线程执行的</p></blockquote> <ul><li><p>如何证明js执行是单线程的?</p> <p>setTimeout()的回调函数是在主线程执行的，<strong>定时器回调函数只有在运行栈中的代码全部执行完后才有可能执行</strong>。</p></li> <li><p>为什么js要用单线程模式, 而不用多线程模式?</p> <p>JavaScript的单线程，与它的用途有关。作为浏览器脚本语言，JavaScript的主要用途是与用户互动，以及操作DOM。这决定了它只能是单线程，否则会带来很复杂的同步问题。</p></li> <li><p>代码的分类</p> <p>初始化代码、回调代码。</p></li> <li><p>js引擎执行代码的基本流程</p> <p>（1）<strong>先执行初始化代码</strong>，包含一些特别的代码  回调函数（异步执行）</p> <p>设置定时器、绑定监听、发送ajax请求。</p> <p>（2）<strong>后面在某个时刻</strong>才会执行回调代码（要保证初始化代码执行完）。</p></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'timeout 2222'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">2000</span><span class="token punctuation">)</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token string">'timeout 1111'</span> <span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span>
<span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'fn()'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'alert()之前'</span><span class="token punctuation">)</span>

<span class="token comment">//暂停当前主线程的执行，同时暂停计时，点击确定后，恢复程序执行和计时</span>
<span class="token function">aler</span><span class="token punctuation">(</span><span class="token string">'-------'</span><span class="token punctuation">)</span> 
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'alert()之后'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p><strong>后面在某个时刻</strong>才会执行回调代码（要保证初始化代码执行完才会执行回调代码）。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token comment">//1 2 3</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><blockquote><p>浏览器的事件循环(轮询)模型</p></blockquote> <ul><li><p>所有代码分类</p> <p>初始化执行代码(同步代码): 包含綁定dom事件监听， 设置定时器， 发送ajax请求的代码；</p> <p>回调执行代码(异步代码): 处理回调逻辑。</p></li> <li><p>js引擎执行代码的基本流程: 初始化代码===&gt;回调代码</p></li> <li><p>模型的2个重要组成部分: 事件管理模块、回调队列</p></li> <li><p>模型的运转流程：</p> <p>执行初始化代码，将事件回调函数交给对应模块管理；</p> <p>当事件发生时，管理模块会将回 调函数及其数据添加到回调列队中；</p> <p>只有当初始化代码执行完后(可能要一定时间)， 才会遍历读取回调队列中的回调函数执行。</p></li> <li><p>模型原理图</p></li></ul> <img src="/assets/img/16.3a902d26.png" align="center"> <ul><li><p>相关重要概念</p> <ul><li><p>执行栈：execution stack，所有的代码都是在此空间中执行的</p></li> <li><p>浏览器内核：browser core，js引擎模块(在主线程处理)、其它模块(在主/分线程处理)</p></li> <li><p>同一个: callback queue</p> <p>任务队列：task queue</p> <p>消息队列：message queue</p> <p>事件队列：event queue</p></li> <li><p>事件轮询：event loop，从任务队列中循环取出回调函数放入执行栈中处理(一个接一个)。</p></li> <li><p>事件驱动模型：event-driven interaction model</p></li> <li><p>请求响应模型：request-response model</p></li></ul></li></ul> <blockquote><p>H5 Web Workers(多线程)</p></blockquote> <ul><li><p>介绍
Web Workers 是 HTML5 提供的一个javascript多线程解决方案，我们可以将一些大计算量的代码交由web Worker运行而不冻结用户界面，但是子线程完全受主线程控制，且不得操作DOM。所以，这个新标准并没有改变JavaScript单线程的本质</p></li> <li><p>使用
创建在分线程执行的js文件</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">onmessage</span> <span class="token operator">=</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">//不能用函数声明</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'onMessage()22'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> upper <span class="token operator">=</span> event<span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//通过event.data获得发送来的数据</span>
    <span class="token function">postMessage</span><span class="token punctuation">(</span>upper<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//将获取到的数据发送会主线程</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>在主线程中的js中发消息并设置回调。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//创建一个Worker对象并向它传递将在新线程中执行的脚本的URL</span>
<span class="token keyword">var</span> worker <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Worker</span><span class="token punctuation">(</span><span class="token string">&quot;worker.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token comment">//接收worker传过来的数据函数</span>
worker<span class="token punctuation">.</span><span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>   
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>         
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//向worker发送数据</span>
worker<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token string">&quot;hello world&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></li> <li><p>图解
<img src="/assets/img/17.8d00b87b.png" align="center"></p></li> <li><p>相关API</p> <p>Worker: 构造函数，加载分线程执行的js文件；</p> <p>Worker.prototype.onmessage: 用于接收另-一个线程的回调函数；</p> <p>Worker.prototype.postMessage: 向另一个线程发送消息。</p></li> <li><p>不足</p> <p>worker 内代码不能操作DOM(更新UI)；</p> <p>不能跨域加载JS；</p> <p>不是每个浏览器都支持这个新特性。</p></li></ul> <h3 id="启动服务"><a href="#启动服务" class="header-anchor">#</a> 启动服务</h3> <p>cd C:\Users\Lct\Desktop\Aaving.github.io\docs</p> <p>docsify serve</p></div></section> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新: </span> <span class="time">Tue May 17 2022 11:01:03 GMT+0800</span></div></footer> <!----> <div class="comments-wrapper"><!----></div></main></div> <!----></div> <ul class="sub-sidebar sub-sidebar-wrapper" style="width:12rem;" data-v-b57cc07c data-v-7dd95ae2><li class="level-3" data-v-b57cc07c><a href="/notes/frontend/JS-advance.html#_1-数据类型" class="sidebar-link reco-side-_1-数据类型" data-v-b57cc07c>1.数据类型</a></li><li class="level-3" data-v-b57cc07c><a href="/notes/frontend/JS-advance.html#_2-相关问题" class="sidebar-link reco-side-_2-相关问题" data-v-b57cc07c>2.相关问题</a></li><li class="level-3" data-v-b57cc07c><a href="/notes/frontend/JS-advance.html#_3-函数及this" class="sidebar-link reco-side-_3-函数及this" data-v-b57cc07c>3.函数及this</a></li><li class="level-3" data-v-b57cc07c><a href="/notes/frontend/JS-advance.html#_4-原型及原型链" class="sidebar-link reco-side-_4-原型及原型链" data-v-b57cc07c>4.原型及原型链</a></li><li class="level-3" data-v-b57cc07c><a href="/notes/frontend/JS-advance.html#_5-执行上下文与执行上下文栈" class="sidebar-link reco-side-_5-执行上下文与执行上下文栈" data-v-b57cc07c>5.执行上下文与执行上下文栈</a></li><li class="level-3" data-v-b57cc07c><a href="/notes/frontend/JS-advance.html#_6-作用域与作用域链" class="sidebar-link reco-side-_6-作用域与作用域链" data-v-b57cc07c>6.作用域与作用域链</a></li><li class="level-3" data-v-b57cc07c><a href="/notes/frontend/JS-advance.html#_7-闭包" class="sidebar-link reco-side-_7-闭包" data-v-b57cc07c>7.闭包</a></li><li class="level-3" data-v-b57cc07c><a href="/notes/frontend/JS-advance.html#_8-对象创建模式" class="sidebar-link reco-side-_8-对象创建模式" data-v-b57cc07c>8.对象创建模式</a></li><li class="level-3" data-v-b57cc07c><a href="/notes/frontend/JS-advance.html#_9-继承模式" class="sidebar-link reco-side-_9-继承模式" data-v-b57cc07c>9.继承模式</a></li><li class="level-3" data-v-b57cc07c><a href="/notes/frontend/JS-advance.html#_10-线程机制与事件机制" class="sidebar-link reco-side-_10-线程机制与事件机制" data-v-b57cc07c>10.线程机制与事件机制</a></li><li class="level-3" data-v-b57cc07c><a href="/notes/frontend/JS-advance.html#启动服务" class="sidebar-link reco-side-启动服务" data-v-b57cc07c>启动服务</a></li></ul></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div><!----><canvas id="vuepress-canvas-cursor"></canvas><div class="kanbanniang" data-v-5775ee02><div class="banniang-container" style="display:;" data-v-5775ee02><div class="messageBox" style="right:68px;bottom:190px;display:none;" data-v-5775ee02>
      欢迎来到 Aavin's blog
    </div> <div class="operation" style="right:90px;bottom:40px;display:none;" data-v-5775ee02><i class="kbnfont kbn-ban-home ban-home" data-v-5775ee02></i> <i class="kbnfont kbn-ban-message message" data-v-5775ee02></i> <i class="kbnfont kbn-ban-close close" data-v-5775ee02></i> <a target="_blank" href="https://vuepress-theme-reco.recoluan.com/views/plugins/kanbanniang.html" data-v-5775ee02><i class="kbnfont kbn-ban-info info" data-v-5775ee02></i></a> <i class="kbnfont kbn-ban-theme skin" style="display:;" data-v-5775ee02></i></div> <canvas id="banniang" width="80" height="150" class="live2d" style="right:30px;bottom:-20px;opacity:0.8;" data-v-5775ee02></canvas></div> <div class="showBanNiang" style="display:none;" data-v-5775ee02>
    看板娘
  </div></div></div></div>
    <script src="/assets/js/app.7562fe1d.js" defer></script><script src="/assets/js/3.9f83703d.js" defer></script><script src="/assets/js/1.37c29b95.js" defer></script><script src="/assets/js/7.8b4bf124.js" defer></script><script src="/assets/js/16.170be8d2.js" defer></script>
  </body>
</html>
